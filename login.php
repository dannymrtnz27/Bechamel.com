<?php
include 'config.php';

session_start();

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $nombre_usuario = trim($_POST['nombre_usuario']); // Asegúrate de limpiar los datos de entrada
    $contrasena = $_POST['contrasena'];

    // Preparar la consulta SQL
    $sql = "SELECT * FROM usuarios WHERE nombre = ?";
    $stmt = $conn->prepare($sql);
    $stmt->bind_param("s", $nombre_usuario);
    $stmt->execute();
    $resultado = $stmt->get_result();

    if ($fila = $resultado->fetch_assoc()) {
        // Verificar la contraseña
        if (password_verify($contrasena, $fila['password_hash'])) {
            $_SESSION['usuario'] = $fila['nombre']; // Inicia sesión guardando el nombre del usuario
            echo "Inicio de sesión exitoso. <a href='bienvenida.php'>Ir a la página principal</a>.";
        } else {
            echo "Contraseña incorrecta.";
        }
    } else {
        echo "Usuario no encontrado.";
    }

    // Cerrar la consulta y la conexión
    $stmt->close();
    $conn->close();
}
?>
<!doctype html>
<html lang="ES">
<head>
    <title>Inicio de Sesión</title>
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css?v=1.0.1">
</head>
<body>
    <div class="contenedorRegistro">
        <h1>Inicio de Sesión</h1>
        <form method="POST" class="form">
            <label for="nombre_usuario">Nombre de usuario:</label>
            <input type="name" name="nombre_usuario" required>
            <br>
            <label for="contrasena">Contraseña:</label>
            <input type="password" name="contrasena" required>
            <br>
            <button type="submit">Iniciar Sesión</button>
            <div>
                <svg class="bechamelbrand" width="158" height="44" viewBox="0 0 158 44" fill="none">
                    <path d="M4.68 16.5264C3.864 16.5264 3.156 16.2504 2.556 15.6984C1.98 15.1464 1.692 14.4864 1.692 13.7184C1.692 12.9504 1.98 12.2904 2.556 11.7384C3.156 11.1864 3.864 10.9104 4.68 10.9104C5.496 10.9104 6.192 11.1864 6.768 11.7384C7.344 12.2904 7.632 12.9504 7.632 13.7184C7.632 14.4864 7.344 15.1464 6.768 15.6984C6.192 16.2504 5.496 16.5264 4.68 16.5264ZM1.584 18.5784H7.74V35.1384H1.584V18.5784ZM24.4364 24.3024C26.0684 24.4944 27.2324 25.0464 27.9284 25.9584C28.6244 26.8464 28.9724 27.9264 28.9724 29.1984C28.9724 29.9904 28.8524 30.7464 28.6124 31.4664C28.3724 32.1624 28.0844 32.7624 27.7484 33.2664C27.4124 33.7464 27.1244 34.0584 26.8844 34.2024C25.9244 34.8264 22.9964 35.1384 18.1004 35.1384H11.1164V14.6184H19.5764C21.4964 14.6184 23.0444 14.7264 24.2204 14.9424C25.4204 15.1344 26.3924 15.5904 27.1364 16.3104C27.8804 17.0064 28.2524 18.0744 28.2524 19.5144C28.2524 20.7624 27.9404 21.7704 27.3164 22.5384C26.7164 23.3064 25.7564 23.8344 24.4364 24.1224V24.3024ZM21.5564 18.9744C21.3164 18.7344 21.0284 18.5904 20.6924 18.5424C20.3804 18.4704 19.8764 18.4344 19.1804 18.4344C18.4844 18.4344 17.9564 18.4464 17.5964 18.4704V22.8624H17.9564C18.0764 22.8624 18.5804 22.8624 19.4684 22.8624C20.3564 22.8624 20.9444 22.8024 21.2324 22.6824C21.4484 22.5864 21.6404 22.3344 21.8084 21.9264C22.0004 21.5184 22.0964 21.0744 22.0964 20.5944C22.0964 19.8744 21.9164 19.3344 21.5564 18.9744ZM22.1684 30.9984C22.3364 30.8544 22.4684 30.5904 22.5644 30.2064C22.6844 29.7984 22.7444 29.3904 22.7444 28.9824C22.7444 28.4784 22.6724 28.0104 22.5284 27.5784C22.4084 27.1224 22.2404 26.7984 22.0244 26.6064C21.8084 26.3904 21.4964 26.2464 21.0884 26.1744C20.7044 26.1024 20.0444 26.0664 19.1084 26.0664C18.5084 26.0664 18.0044 26.0784 17.5964 26.1024V31.3224C18.7244 31.3464 19.7324 31.3344 20.6204 31.2864C21.5084 31.2144 22.0244 31.1184 22.1684 30.9984ZM41.4028 30.8184C42.0028 30.8184 43.1188 30.7584 44.7508 30.6384C44.9668 30.6384 45.3628 30.6144 45.9388 30.5664L46.4788 34.2744C44.6308 35.1384 42.2308 35.5704 39.2788 35.5704C36.5188 35.5704 34.3948 34.8744 32.9068 33.4824C31.4428 32.0904 30.7108 29.9904 30.7108 27.1824C30.7108 25.7424 30.8908 24.3504 31.2508 23.0064C31.6348 21.6624 32.0668 20.7264 32.5468 20.1984C33.0508 19.6704 33.9868 19.2144 35.3548 18.8304C36.7228 18.4464 38.0788 18.2544 39.4228 18.2544C41.5828 18.2544 43.2028 18.6384 44.2828 19.4064C45.3628 20.1744 46.0708 21.2424 46.4068 22.6104C46.7428 23.9544 46.9108 25.7664 46.9108 28.0464C45.2788 28.1424 43.6828 28.1904 42.1228 28.1904H37.0108C37.0108 28.9584 37.1668 29.5344 37.4788 29.9184C37.8148 30.3024 38.2828 30.5544 38.8828 30.6744C39.4828 30.7704 40.3228 30.8184 41.4028 30.8184ZM37.3708 22.5384C37.2268 22.6104 37.1188 22.9224 37.0468 23.4744C36.9748 24.0264 36.9268 24.6504 36.9028 25.3464H38.7748C39.9028 25.3464 40.7188 25.3344 41.2228 25.3104C41.2228 24.1584 41.0548 23.3424 40.7188 22.8624C40.4068 22.3824 39.8548 22.1424 39.0628 22.1424C38.4148 22.1424 37.8508 22.2744 37.3708 22.5384ZM63.0096 34.6344C61.0656 35.2824 58.8936 35.6064 56.4936 35.6064C53.8056 35.6064 51.7896 34.9344 50.4456 33.5904C49.1256 32.2224 48.4656 30.0984 48.4656 27.2184C48.4656 25.8024 48.6576 24.4104 49.0416 23.0424C49.4256 21.6504 49.8336 20.7144 50.2656 20.2344C50.7696 19.6824 51.7536 19.2144 53.2176 18.8304C54.7056 18.4464 56.2416 18.2544 57.8256 18.2544C59.4816 18.2544 61.1496 18.3984 62.8296 18.6864C62.7816 19.2864 62.6976 19.9944 62.5776 20.8104C62.4816 21.6024 62.3736 22.3104 62.2536 22.9344C60.7656 22.8384 59.3616 22.7904 58.0416 22.7904C56.7456 22.7904 55.9176 22.8624 55.5576 23.0064C55.3656 23.0784 55.1856 23.5704 55.0176 24.4824C54.8736 25.3944 54.8016 26.2464 54.8016 27.0384C54.8016 28.0944 54.9456 28.9104 55.2336 29.4864C55.5456 30.0384 56.0256 30.4224 56.6736 30.6384C57.3216 30.8544 58.1976 30.9624 59.3016 30.9624C59.7816 30.9624 60.8376 30.9144 62.4696 30.8184L63.0096 34.6344ZM81.0937 19.6224C81.3097 19.8864 81.4657 20.5464 81.5617 21.6024C81.6817 22.6584 81.7417 24.2664 81.7417 26.4264V35.1384H75.5857V26.4984C75.5857 26.4024 75.5857 25.9344 75.5857 25.0944C75.5857 24.2304 75.5257 23.7024 75.4057 23.5104C75.3337 23.4144 75.1537 23.3424 74.8657 23.2944C74.6017 23.2464 74.2897 23.2224 73.9297 23.2224L73.3177 23.2584C72.6457 23.2824 71.9497 23.4384 71.2297 23.7264V35.1384H65.0737V13.5384L71.2297 13.2864V17.4984C71.2297 19.2264 71.1697 20.3784 71.0497 20.9544L71.0857 20.9904C72.7177 19.1424 74.6737 18.2184 76.9537 18.2184C77.8177 18.2184 78.6217 18.3384 79.3657 18.5784C80.1337 18.8184 80.7097 19.1664 81.0937 19.6224ZM94.4494 35.1384L93.8734 32.8704C92.7694 34.6704 91.2334 35.5704 89.2654 35.5704C87.6574 35.5704 86.3374 35.1264 85.3054 34.2384C84.2974 33.3264 83.7934 32.0544 83.7934 30.4224C83.7934 29.4144 84.0814 28.5384 84.6574 27.7944C85.2574 27.0264 86.0734 26.4864 87.1054 26.1744C88.4494 25.7904 90.5254 25.5744 93.3334 25.5264C93.3334 23.9424 93.2614 23.1024 93.1174 23.0064C92.9974 22.9104 92.6134 22.8624 91.9654 22.8624C91.5574 22.8624 90.9934 22.8864 90.2734 22.9344C89.1214 22.9824 87.5614 23.1144 85.5934 23.3304C85.4014 22.0344 85.2574 20.6424 85.1614 19.1544C86.4334 18.8904 87.7654 18.6744 89.1574 18.5064C90.5494 18.3144 91.7974 18.2184 92.9014 18.2184C94.8214 18.2184 96.2614 18.5424 97.2214 19.1904C98.1814 19.8144 98.8054 20.6424 99.0934 21.6744C99.3814 22.7064 99.5134 24.0144 99.4894 25.5984L99.4534 30.8904L99.5614 35.1384H94.4494ZM91.3534 31.5384C91.9774 31.5384 92.6374 31.4184 93.3334 31.1784V28.5144H93.0454C91.2694 28.5144 90.2854 28.6104 90.0934 28.8024C89.9734 28.9224 89.8774 29.1024 89.8054 29.3424C89.7574 29.5824 89.7334 29.8104 89.7334 30.0264C89.7334 30.6024 89.8654 30.9984 90.1294 31.2144C90.3934 31.4304 90.8014 31.5384 91.3534 31.5384ZM128.153 19.7304C128.537 20.3064 128.729 22.5384 128.729 26.4264V35.1384H122.573V27.0384V25.0944C122.573 24.2064 122.489 23.6784 122.321 23.5104C122.129 23.3184 121.721 23.2224 121.097 23.2224L120.665 23.2584C119.921 23.3064 119.213 23.4744 118.541 23.7624C118.565 24.2664 118.577 25.1544 118.577 26.4264V35.1384H112.421V27.0384V24.8784C112.421 24.1344 112.337 23.6784 112.169 23.5104C111.977 23.3184 111.569 23.2224 110.945 23.2224L110.513 23.2584C109.841 23.2824 109.145 23.4384 108.425 23.7264V35.1384H102.269V18.5784H107.273L107.921 21.2784C108.713 20.2224 109.625 19.4544 110.657 18.9744C111.689 18.4704 112.733 18.2184 113.789 18.2184C114.677 18.2184 115.517 18.3504 116.309 18.6144C117.125 18.8784 117.689 19.2504 118.001 19.7304C118.145 19.9464 118.265 20.3424 118.361 20.9184C119.129 19.9824 120.005 19.2984 120.989 18.8664C121.973 18.4344 122.957 18.2184 123.941 18.2184C124.829 18.2184 125.669 18.3504 126.461 18.6144C127.277 18.8784 127.841 19.2504 128.153 19.7304ZM141.633 30.8184C142.233 30.8184 143.349 30.7584 144.981 30.6384C145.197 30.6384 145.593 30.6144 146.169 30.5664L146.709 34.2744C144.861 35.1384 142.461 35.5704 139.509 35.5704C136.749 35.5704 134.625 34.8744 133.137 33.4824C131.673 32.0904 130.941 29.9904 130.941 27.1824C130.941 25.7424 131.121 24.3504 131.481 23.0064C131.865 21.6624 132.297 20.7264 132.777 20.1984C133.281 19.6704 134.217 19.2144 135.585 18.8304C136.953 18.4464 138.309 18.2544 139.653 18.2544C141.813 18.2544 143.433 18.6384 144.513 19.4064C145.593 20.1744 146.301 21.2424 146.637 22.6104C146.973 23.9544 147.141 25.7664 147.141 28.0464C145.509 28.1424 143.913 28.1904 142.353 28.1904H137.241C137.241 28.9584 137.397 29.5344 137.709 29.9184C138.045 30.3024 138.513 30.5544 139.113 30.6744C139.713 30.7704 140.553 30.8184 141.633 30.8184ZM137.601 22.5384C137.457 22.6104 137.349 22.9224 137.277 23.4744C137.205 24.0264 137.157 24.6504 137.133 25.3464H139.005C140.133 25.3464 140.949 25.3344 141.453 25.3104C141.453 24.1584 141.285 23.3424 140.949 22.8624C140.637 22.3824 140.085 22.1424 139.293 22.1424C138.645 22.1424 138.081 22.2744 137.601 22.5384ZM149.416 13.5384L155.572 13.2864V35.1384H149.416V13.5384Z"/>
                    <line x1="1.31134e-07" y1="42.3616" x2="158" y2="42.3616" stroke-width="3"/>
                </svg>
                    
            </div>
        </form>
    </div>
</body>
</html>
